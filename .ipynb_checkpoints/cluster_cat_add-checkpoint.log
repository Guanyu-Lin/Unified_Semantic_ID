nohup: ignoring input
Namespace(data_dir='../seqRec/data/', output_dir='output/', data_name='Beauty', only_semantic=False, text_embedding_file='Beautytext_emb.pt', semantic_name='Beauty2561.032cosidToSemanticId.json', do_eval=False, ckp=10, model_name='Finetune_sample', hidden_size=64, id_dim_size=8, reshape_size=72, semantic_dim_size=64, codebook_n_layer=3, cluster_size=50, codebook_size=256, num_hidden_layers=2, num_attention_heads=2, hidden_act='gelu', attention_probs_dropout_prob=0.5, hidden_dropout_prob=0.5, initializer_range=0.02, max_seq_length=50, w=1, rq_loss_weight=1.0, distance_type='hybrid', is_cluster=True, add_cluster='add', is_text=True, is_reconstruction=True, lr=0.001, batch_size=256, epochs=200, no_cuda=False, log_freq=1, seed=42, weight_decay=0.0, adam_beta1=0.9, adam_beta2=0.999, gpu_id='0', code_embedding_file='Beauty2561.032cos.pt', cuda_condition=True, data_file='../seqRec/data/Beauty.txt', sample_file='../seqRec/data/Beauty_sample.txt', item_size=12103, user_size=22364, mask_id=12102, max_seq_length_all=201, log_file='output/2-64-Beauty-8-3-256-64-hybrid-reconstruction-cluster-add.txt')
Beautytext_emb.pt
Total Parameters: 10932760
Recommendation EP_train:0:   0%|| 0/88 [00:00<?, ?it/s]Recommendation EP_train:0:   1%|| 1/88 [00:00<00:58,  1.50it/s]Recommendation EP_train:0:   2%|| 2/88 [00:00<00:29,  2.90it/s]Recommendation EP_train:0:   3%|| 3/88 [00:00<00:20,  4.20it/s]Recommendation EP_train:0:   6%|| 5/88 [00:01<00:13,  6.35it/s]Recommendation EP_train:0:   7%|| 6/88 [00:01<00:11,  6.91it/s]Recommendation EP_train:0:   8%|| 7/88 [00:01<00:11,  7.32it/s]Recommendation EP_train:0:   9%|| 8/88 [00:01<00:10,  7.79it/s]Recommendation EP_train:0:  10%|| 9/88 [00:01<00:09,  8.33it/s]Recommendation EP_train:0:  12%|| 11/88 [00:01<00:09,  8.02it/s]Recommendation EP_train:0:  14%|| 12/88 [00:01<00:09,  8.22it/s]Recommendation EP_train:0:  16%|| 14/88 [00:02<00:08,  8.91it/s]Recommendation EP_train:0:  17%|| 15/88 [00:02<00:08,  8.78it/s]Recommendation EP_train:0:  18%|| 16/88 [00:02<00:07,  9.03it/s]Recommendation EP_train:0:  19%|| 17/88 [00:02<00:07,  8.99it/s]Recommendation EP_train:0:  20%|| 18/88 [00:02<00:08,  8.08it/s]Recommendation EP_train:0:  22%|| 19/88 [00:02<00:08,  8.02it/s]Recommendation EP_train:0:  23%|| 20/88 [00:02<00:09,  7.02it/s]Recommendation EP_train:0:  24%|| 21/88 [00:03<00:12,  5.35it/s]Recommendation EP_train:0:  25%|| 22/88 [00:03<00:11,  5.90it/s]Recommendation EP_train:0:  26%|| 23/88 [00:03<00:10,  5.93it/s]Recommendation EP_train:0:  27%|| 24/88 [00:03<00:09,  6.73it/s]Recommendation EP_train:0:  28%|| 25/88 [00:03<00:08,  7.37it/s]Recommendation EP_train:0:  30%|| 26/88 [00:03<00:07,  7.77it/s]Recommendation EP_train:0:  31%|| 27/88 [00:03<00:07,  8.00it/s]Recommendation EP_train:0:  32%|| 28/88 [00:04<00:07,  8.50it/s]Recommendation EP_train:0:  33%|| 29/88 [00:04<00:06,  8.90it/s]Recommendation EP_train:0:  34%|| 30/88 [00:04<00:06,  9.18it/s]Recommendation EP_train:0:  35%|| 31/88 [00:04<00:06,  8.19it/s]Recommendation EP_train:0:  36%|| 32/88 [00:04<00:06,  8.19it/s]Recommendation EP_train:0:  38%|| 33/88 [00:04<00:06,  8.20it/s]Recommendation EP_train:0:  40%|| 35/88 [00:04<00:06,  8.37it/s]Recommendation EP_train:0:  41%|| 36/88 [00:04<00:06,  8.38it/s]Recommendation EP_train:0:  42%|| 37/88 [00:05<00:06,  8.48it/s]Recommendation EP_train:0:  43%|| 38/88 [00:05<00:05,  8.74it/s]Recommendation EP_train:0:  45%|| 40/88 [00:05<00:05,  9.35it/s]Recommendation EP_train:0:  47%|| 41/88 [00:05<00:05,  9.38it/s]Recommendation EP_train:0:  48%|| 42/88 [00:05<00:05,  9.17it/s]Recommendation EP_train:0:  49%|| 43/88 [00:05<00:05,  8.42it/s]Recommendation EP_train:0:  50%|| 44/88 [00:05<00:05,  8.37it/s]Recommendation EP_train:0:  51%|| 45/88 [00:05<00:05,  8.47it/s]Recommendation EP_train:0:  52%|| 46/88 [00:06<00:04,  8.65it/s]Recommendation EP_train:0:  53%|| 47/88 [00:06<00:05,  7.39it/s]Recommendation EP_train:0:  55%|| 48/88 [00:06<00:05,  7.82it/s]Recommendation EP_train:0:  57%|| 50/88 [00:06<00:04,  8.78it/s]Recommendation EP_train:0:  58%|| 51/88 [00:06<00:04,  8.82it/s]Recommendation EP_train:0:  59%|| 52/88 [00:06<00:04,  8.80it/s]Recommendation EP_train:0:  60%|| 53/88 [00:06<00:03,  8.96it/s]Recommendation EP_train:0:  61%|| 54/88 [00:07<00:03,  9.22it/s]Recommendation EP_train:0:  62%|| 55/88 [00:07<00:03,  9.35it/s]Recommendation EP_train:0:  64%|| 56/88 [00:07<00:03,  8.67it/s]Recommendation EP_train:0:  65%|| 57/88 [00:07<00:03,  8.54it/s]Recommendation EP_train:0:  66%|| 58/88 [00:07<00:03,  8.67it/s]Recommendation EP_train:0:  68%|| 60/88 [00:07<00:03,  9.27it/s]Recommendation EP_train:0:  69%|| 61/88 [00:07<00:02,  9.31it/s]Recommendation EP_train:0:  70%|| 62/88 [00:07<00:02,  8.89it/s]Recommendation EP_train:0:  73%|| 64/88 [00:08<00:02,  9.52it/s]Recommendation EP_train:0:  74%|| 65/88 [00:08<00:02,  9.45it/s]Recommendation EP_train:0:  75%|| 66/88 [00:08<00:02,  9.55it/s]Recommendation EP_train:0:  76%|| 67/88 [00:08<00:02,  8.31it/s]Recommendation EP_train:0:  78%|| 69/88 [00:08<00:02,  8.93it/s]Recommendation EP_train:0:  80%|| 70/88 [00:08<00:01,  9.08it/s]Recommendation EP_train:0:  81%|| 71/88 [00:09<00:02,  7.45it/s]Recommendation EP_train:0:  82%|| 72/88 [00:09<00:02,  7.64it/s]Recommendation EP_train:0:  83%|| 73/88 [00:09<00:01,  7.97it/s]Recommendation EP_train:0:  84%|| 74/88 [00:09<00:01,  8.00it/s]Recommendation EP_train:0:  85%|| 75/88 [00:09<00:01,  8.07it/s]Recommendation EP_train:0:  86%|| 76/88 [00:09<00:01,  8.44it/s]Recommendation EP_train:0:  88%|| 77/88 [00:09<00:01,  8.83it/s]Recommendation EP_train:0:  90%|| 79/88 [00:09<00:00,  9.16it/s]Recommendation EP_train:0:  91%|| 80/88 [00:10<00:00,  9.25it/s]Recommendation EP_train:0:  92%|| 81/88 [00:10<00:00,  8.91it/s]Recommendation EP_train:0:  93%|| 82/88 [00:10<00:00,  9.16it/s]Recommendation EP_train:0:  94%|| 83/88 [00:10<00:00,  9.34it/s]Recommendation EP_train:0:  95%|| 84/88 [00:10<00:00,  8.09it/s]Recommendation EP_train:0:  97%|| 85/88 [00:10<00:00,  8.50it/s]Recommendation EP_train:0:  99%|| 87/88 [00:10<00:00,  9.15it/s]Recommendation EP_train:0: 100%|| 88/88 [00:10<00:00,  9.09it/s]Recommendation EP_train:0: 100%|| 88/88 [00:10<00:00,  8.07it/s]
{'epoch': 0, 'rec_avg_loss': '1.4883', 'rec_cur_loss': '1.3431'}
Recommendation EP_test:0:   0%|| 0/88 [00:00<?, ?it/s]Recommendation EP_test:0:   1%|| 1/88 [00:00<00:33,  2.62it/s]Recommendation EP_test:0:   2%|| 2/88 [00:00<00:22,  3.85it/s]Recommendation EP_test:0:   3%|| 3/88 [00:00<00:16,  5.28it/s]Recommendation EP_test:0:   5%|| 4/88 [00:00<00:13,  6.30it/s]Recommendation EP_test:0:   6%|| 5/88 [00:00<00:11,  7.13it/s]Recommendation EP_test:0:   7%|| 6/88 [00:01<00:12,  6.50it/s]Recommendation EP_test:0:   8%|| 7/88 [00:01<00:11,  7.08it/s]Recommendation EP_test:0:   9%|| 8/88 [00:01<00:12,  6.51it/s]Recommendation EP_test:0:  10%|| 9/88 [00:01<00:15,  5.06it/s]Recommendation EP_test:0:  11%|| 10/88 [00:01<00:15,  5.00it/s]Recommendation EP_test:0:  12%|| 11/88 [00:01<00:13,  5.90it/s]Recommendation EP_test:0:  14%|| 12/88 [00:02<00:11,  6.61it/s]Recommendation EP_test:0:  15%|| 13/88 [00:02<00:12,  6.15it/s]Recommendation EP_test:0:  16%|| 14/88 [00:02<00:15,  4.88it/s]Recommendation EP_test:0:  17%|| 15/88 [00:02<00:13,  5.60it/s]Recommendation EP_test:0:  18%|| 16/88 [00:02<00:15,  4.77it/s]Recommendation EP_test:0:  19%|| 17/88 [00:03<00:12,  5.57it/s]Recommendation EP_test:0:  20%|| 18/88 [00:03<00:12,  5.48it/s]Recommendation EP_test:0:  22%|| 19/88 [00:03<00:11,  6.20it/s]Recommendation EP_test:0:  23%|| 20/88 [00:03<00:11,  5.85it/s]Recommendation EP_test:0:  24%|| 21/88 [00:03<00:10,  6.66it/s]Recommendation EP_test:0:  25%|| 22/88 [00:03<00:10,  6.18it/s]Recommendation EP_test:0:  26%|| 23/88 [00:03<00:09,  6.76it/s]Recommendation EP_test:0:  27%|| 24/88 [00:04<00:12,  5.17it/s]Recommendation EP_test:0:  28%|| 25/88 [00:04<00:14,  4.46it/s]Recommendation EP_test:0:  30%|| 26/88 [00:05<00:18,  3.28it/s]Recommendation EP_test:0:  31%|| 27/88 [00:05<00:20,  2.94it/s]Recommendation EP_test:0:  32%|| 28/88 [00:05<00:23,  2.57it/s]Recommendation EP_test:0:  33%|| 29/88 [00:06<00:24,  2.37it/s]Recommendation EP_test:0:  34%|| 30/88 [00:06<00:25,  2.27it/s]Recommendation EP_test:0:  35%|| 31/88 [00:07<00:26,  2.18it/s]Recommendation EP_test:0:  36%|| 32/88 [00:07<00:26,  2.13it/s]Recommendation EP_test:0:  38%|| 33/88 [00:08<00:25,  2.20it/s]Recommendation EP_test:0:  39%|| 34/88 [00:08<00:25,  2.14it/s]Recommendation EP_test:0:  40%|| 35/88 [00:09<00:25,  2.11it/s]Recommendation EP_test:0:  41%|| 36/88 [00:09<00:25,  2.08it/s]Recommendation EP_test:0:  42%|| 37/88 [00:10<00:24,  2.07it/s]Recommendation EP_test:0:  43%|| 38/88 [00:10<00:24,  2.04it/s]Recommendation EP_test:0:  44%|| 39/88 [00:11<00:22,  2.14it/s]Recommendation EP_test:0:  45%|| 40/88 [00:11<00:22,  2.11it/s]Recommendation EP_test:0:  47%|| 41/88 [00:11<00:18,  2.54it/s]Recommendation EP_test:0:  48%|| 42/88 [00:12<00:19,  2.36it/s]Recommendation EP_test:0:  49%|| 43/88 [00:12<00:16,  2.80it/s]Recommendation EP_test:0:  50%|| 44/88 [00:13<00:17,  2.50it/s]Recommendation EP_test:0:  51%|| 45/88 [00:13<00:17,  2.50it/s]Recommendation EP_test:0:  52%|| 46/88 [00:14<00:18,  2.33it/s]Recommendation EP_test:0:  53%|| 47/88 [00:14<00:15,  2.57it/s]Recommendation EP_test:0:  55%|| 48/88 [00:14<00:12,  3.29it/s]Recommendation EP_test:0:  56%|| 49/88 [00:14<00:10,  3.72it/s]Recommendation EP_test:0:  57%|| 50/88 [00:15<00:12,  2.95it/s]Recommendation EP_test:0:  58%|| 51/88 [00:15<00:13,  2.78it/s]Recommendation EP_test:0:  59%|| 52/88 [00:16<00:14,  2.50it/s]Recommendation EP_test:0:  60%|| 53/88 [00:16<00:15,  2.31it/s]Recommendation EP_test:0:  61%|| 54/88 [00:17<00:15,  2.22it/s]Recommendation EP_test:0:  62%|| 55/88 [00:17<00:15,  2.15it/s]Recommendation EP_test:0:  64%|| 56/88 [00:18<00:15,  2.09it/s]Recommendation EP_test:0:  65%|| 57/88 [00:18<00:14,  2.19it/s]Recommendation EP_test:0:  66%|| 58/88 [00:18<00:11,  2.67it/s]Recommendation EP_test:0:  67%|| 59/88 [00:19<00:11,  2.60it/s]Recommendation EP_test:0:  68%|| 60/88 [00:19<00:10,  2.55it/s]